import{a as f}from"./chunk-LUL2EJHL.js";import{F as n,H as c,M as g,fa as h,g as o,j as i,s as r,w as s}from"./chunk-YAUTG46X.js";var l=class a{constructor(t){this.httpClient=t;if(this.isCacheExpired())this.clearCache();else{let e=this.getDataStorage();e&&this.data.set(e||{})}}data=h({});configLoaded=new o(!1);timeCache=60*60*1e3;NameConfigCache="cc_config";NameConfigs="configs";getData(t){return t?localStorage.getItem(this.NameConfigs)&&!this.isCacheExpired()?(this.data.set(this.getDataStorage()||"{}"),i()):this.httpClient.get(`/data/${t}.json`).pipe(n(e=>{this.setDataStorage(e),this.setCache(),this.configLoaded.next(!0)})):i()}setCache(){localStorage.setItem(this.NameConfigCache,JSON.stringify(new Date().setMilliseconds(this.timeCache)))}setDataStorage(t){this.data.set(t),localStorage.setItem(this.NameConfigs,btoa(JSON.stringify(t)))}getDataStorage(){let t=localStorage.getItem(this.NameConfigs);return t?JSON.parse(atob(t)):null}clearCache(){localStorage.removeItem(this.NameConfigs),localStorage.removeItem(this.NameConfigCache)}isCacheExpired(){let t=localStorage.getItem(this.NameConfigCache);if(!t)return!0;let e=new Date().getTime(),m=new Date(t).getTime();return e-m>this.timeCache}waitForConfig(){return this.configLoaded.asObservable().pipe(r(t=>t),s(1))}static \u0275fac=function(e){return new(e||a)(g(f))};static \u0275prov=c({token:a,factory:a.\u0275fac,providedIn:"root"})};export{l as a};
