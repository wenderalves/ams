import{a as f}from"./chunk-LUL2EJHL.js";import{F as c,H as g,M as l,fa as h,g as r,j as o,s,w as n}from"./chunk-YAUTG46X.js";var m=class a{constructor(t){this.httpClient=t;if(this.isCacheExpired())this.clearCache();else{let e=this.getDataStorage();e&&this.data.set(e||{})}}data=h({});configLoaded=new r(!1);timeCache=60*60*1e3;NameConfigCache="cc_config";NameConfigs="configs";NameClient="cli";getData(t){let e=localStorage.getItem(this.NameClient);return t?e&&e===t&&localStorage.getItem(this.NameConfigs)&&!this.isCacheExpired()?(this.data.set(this.getDataStorage()||"{}"),o()):this.httpClient.get(`/data/${t}.json`).pipe(c(i=>{localStorage.setItem(this.NameClient,t),this.setDataStorage(i),this.setCache(),this.configLoaded.next(!0)})):o()}setCache(){localStorage.setItem(this.NameConfigCache,JSON.stringify(new Date().setMilliseconds(this.timeCache)))}setDataStorage(t){this.data.set(t),localStorage.setItem(this.NameConfigs,btoa(JSON.stringify(t)))}getDataStorage(){let t=localStorage.getItem(this.NameConfigs);return t?JSON.parse(atob(t)):null}clearCache(){localStorage.removeItem(this.NameConfigs),localStorage.removeItem(this.NameConfigCache)}isCacheExpired(){let t=localStorage.getItem(this.NameConfigCache);if(!t)return!0;let e=new Date().getTime(),i=new Date(t).getTime();return e-i>this.timeCache}waitForConfig(){return this.configLoaded.asObservable().pipe(s(t=>t),n(1))}static \u0275fac=function(e){return new(e||a)(l(f))};static \u0275prov=g({token:a,factory:a.\u0275fac,providedIn:"root"})};export{m as a};
